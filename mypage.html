<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>ë§ˆì´í˜ì´ì§€</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  
  <style>
    body { background-color: #f0f2f5; padding: 20px; font-family: 'Segoe UI', 'Malgun Gothic', sans-serif; }
    .main-container { max-width: 900px; margin: 0 auto; padding-bottom: 50px; }
    .hidden { display: none !important; }
    
    .profile-card, .tab-content { background: white; border-radius: 15px; box-shadow: 0 4px 15px rgba(0,0,0,0.05); }
    .profile-card { padding: 30px; margin-bottom: 20px; display: flex; align-items: center; }
    .profile-icon { width: 70px; height: 70px; background: #e9ecef; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 30px; margin-right: 20px; }
    
    /* ì—°ì°¨ ì¹´ë“œ */
    .leave-card { background: white; border-radius: 12px; padding: 20px 15px; text-align: center; box-shadow: 0 2px 8px rgba(0,0,0,0.05); height: 100%; position: relative; }
    .leave-num { font-size: 1.6rem; font-weight: bold; color: #0d6efd; margin-top: 5px; }
    .btn-detail { font-size: 0.8rem; position: absolute; top: 12px; right: 12px; text-decoration: none; cursor: pointer; color: #adb5bd; transition: 0.2s; }
    .btn-detail:hover { color: #0d6efd; transform: scale(1.1); }
    
    .nav-tabs .nav-link { color: #495057; cursor: pointer; }
    .nav-tabs .nav-link.active { font-weight: bold; color: #0d6efd; }
    .tab-content { border: 1px solid #dee2e6; border-top: none; border-radius: 0 0 10px 10px; padding: 25px; }

    .salary-blur { filter: blur(6px); transition: filter 0.3s; cursor: pointer; user-select: none; }
    .salary-blur:hover { filter: blur(0); }
    .salary-detail-table th { background-color: #f8f9fa; font-size: 0.9rem; text-align: center; }
    .salary-detail-table td { font-size: 0.95rem; vertical-align: middle; }
    .amount-text { text-align: right; font-family: 'Consolas', monospace; letter-spacing: -0.5px; }
    .total-row { background-color: #e3f2fd; font-weight: bold; }
    
    .notice-item { cursor: pointer; transition: background 0.2s; }
    .notice-item:hover { background-color: #f8f9fa; }
  </style>
</head>
<body>

<div class="main-container">
  <div class="d-flex justify-content-between align-items-center mb-4">
    <h4 class="fw-bold m-0">ğŸ‘¤ My Page</h4>
    <button onclick="location.href='index.html'" class="btn btn-outline-secondary btn-sm">ğŸ  ë©”ë‰´ë¡œ</button>
  </div>

  <div class="profile-card">
    <div class="profile-icon">ğŸ‘¤</div>
    <div>
      <h4 class="fw-bold mb-1"><span id="dspName">Loading...</span> <span class="badge bg-primary rounded-pill fs-6" id="dspRank">-</span></h4>
      <div class="text-muted">
        <span id="dspDept">-</span> | 
        ì…ì‚¬ì¼: <span id="dspJoin">-</span> 
        (<span id="dspTenure" class="text-primary fw-bold">-</span>)
      </div>
    </div>
  </div>

  <div class="row mb-4 g-3">
    <div class="col-4">
        <div class="leave-card">
            <div class="text-muted small fw-bold">ì‚¬ìš© ê°€ëŠ¥</div>
            <span class="btn-detail" onclick="showAvailableLeaveDetail()" title="ìƒì„¸ë³´ê¸°">ğŸ”</span>
            <div class="leave-num text-dark" id="lvTotal">0</div>
        </div>
    </div>
    <div class="col-4">
        <div class="leave-card">
            <div class="text-muted small fw-bold">ì‚¬ìš©</div>
            <span class="btn-detail" onclick="showUsedLeaveDetail()" title="ìƒì„¸ë³´ê¸°">ğŸ”</span>
            <div class="leave-num text-danger" id="lvUsed">0</div>
        </div>
    </div>
    <div class="col-4">
        <div class="leave-card bg-primary bg-opacity-10 border border-primary">
            <div class="text-primary small fw-bold">ì”ì—¬</div>
            <div class="leave-num text-primary" id="lvRemain">0</div>
        </div>
    </div>
  </div>

  <ul class="nav nav-tabs" id="myTab" role="tablist">
    <li class="nav-item"><button class="nav-link active" data-bs-toggle="tab" data-bs-target="#tabInfo">ë‚´ ì •ë³´ ìˆ˜ì •</button></li>
    <li class="nav-item"><button class="nav-link" data-bs-toggle="tab" data-bs-target="#tabSalary">ğŸ’° ê¸‰ì—¬ ëª…ì„¸ì„œ</button></li>
    <li class="nav-item"><button class="nav-link" data-bs-toggle="tab" data-bs-target="#tabCert">ğŸ“œ ì¦ëª…ì„œ/ê³„ì•½ì„œ</button></li>
    <li class="nav-item"><button class="nav-link" data-bs-toggle="tab" data-bs-target="#tabNotice">ğŸ“¢ ê³µì§€ì‚¬í•­</button></li>
  </ul>

  <div class="tab-content">
    
    <div class="tab-pane fade show active" id="tabInfo">
      <div class="alert alert-light border small mb-3">â„¹ï¸ ì„±ëª…, ì§ê¸‰, ì…ì‚¬ì¼ ë“± í•µì‹¬ ì •ë³´ëŠ” ê´€ë¦¬ìë§Œ ìˆ˜ì • ê°€ëŠ¥í•©ë‹ˆë‹¤.</div>
      <div class="row mb-3">
        <div class="col-md-6 mb-3"><label class="small text-muted">ê¸‰ì—¬ ê³„ì¢Œ</label><input type="text" class="form-control" id="myBank"></div>
        <div class="col-md-6 mb-3"><label class="small text-muted">ê³„ì¢Œë²ˆí˜¸</label><input type="text" class="form-control" id="myAccount"></div>
        <div class="col-12 mb-3"><label class="small text-muted">ì£¼ì†Œ</label><input type="text" class="form-control" id="myAddress"></div>
        <div class="col-md-6 mb-3"><label class="small text-muted">ì „í™”ë²ˆí˜¸</label><input type="text" class="form-control" id="myPhone"></div>
      </div>
      <button type="button" class="btn btn-primary w-100" onclick="updateInfo()">ğŸ’¾ ì •ë³´ ìˆ˜ì • ì €ì¥</button>
    </div>

    <div class="tab-pane fade" id="tabSalary">
      <div class="d-flex justify-content-between align-items-center mb-3">
        <div class="input-group" style="max-width: 250px;">
          <input type="month" class="form-control" id="salaryMonth">
          <button class="btn btn-prima
